import{a as e,b as s,e as r,y as o,j as a}from"./index-BX7dOzwF.js";import{r as i}from"./react-vendor-CNyCdty9.js";import{u as l}from"./i18n-vendor-CvzjU6Pd.js";import"./utils-vendor-euKWYQ_X.js";import"./radix-vendor-D0itpczX.js";import"./ui-vendor-bNvS7E9t.js";const m=()=>{const m=e(),{t:n}=l("authCallback"),{user:t,isLoggedIn:c}=s(),{buildPath:d}=r(),u=d("myMusic"),[b,N]=i.useState("loading"),[x,h]=i.useState(""),[g,v]=i.useState(3),p=i.useCallback(async()=>{try{const e=await o();if(!e)throw new Error(n("error.messages.supabaseInit"));const{data:r,error:a}=await e.auth.getSession();if(a)throw a;if(r.session){const{syncSession:e}=s.getState();if(!(await e()))throw new Error(n("error.messages.sessionSync"));N("success");let r=3;const o=setInterval(()=>{r-=1,v(r),r<=0&&(clearInterval(o),m(u,{replace:!0}))},1e3);return()=>clearInterval(o)}{const e=new URLSearchParams(window.location.search),s=e.get("error"),r=e.get("error_description");if(s)throw new Error(r||s);throw new Error(n("error.messages.noSession"))}}catch(e){N("error");let s=n("error.messages.unknown");e instanceof Error&&(s=e.message),s.includes("Email not confirmed")?s=n("error.messages.emailNotConfirmed"):s.includes("Invalid login credentials")&&(s=n("error.messages.invalidCredentials")),h(s)}},[n,m,u]);i.useEffect(()=>{p()},[p]),i.useEffect(()=>{c&&m(u,{replace:!0})},[c,m,u]);return a.jsxDEV("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:a.jsxDEV("div",{className:"max-w-md w-full space-y-8 p-8",children:a.jsxDEV("div",{className:"text-center",children:["loading"===b&&a.jsxDEV("div",{className:"space-y-4",children:[a.jsxDEV("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"},void 0,!1,{fileName:"/Users/otomiranda/Downloads/memora.music/src/pages/AuthCallback.tsx",lineNumber:122,columnNumber:15},void 0),a.jsxDEV("h2",{className:"text-xl font-semibold text-gray-900",children:n("loading.title")},void 0,!1,{fileName:"/Users/otomiranda/Downloads/memora.music/src/pages/AuthCallback.tsx",lineNumber:123,columnNumber:15},void 0),a.jsxDEV("p",{className:"text-gray-600",children:n("loading.subtitle")},void 0,!1,{fileName:"/Users/otomiranda/Downloads/memora.music/src/pages/AuthCallback.tsx",lineNumber:124,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/otomiranda/Downloads/memora.music/src/pages/AuthCallback.tsx",lineNumber:121,columnNumber:13},void 0),"success"===b&&a.jsxDEV("div",{className:"space-y-4",children:[a.jsxDEV("div",{className:"rounded-full h-12 w-12 bg-green-100 mx-auto flex items-center justify-center",children:a.jsxDEV("svg",{className:"h-6 w-6 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"},void 0,!1,{fileName:"/Users/otomiranda/Downloads/memora.music/src/pages/AuthCallback.tsx",lineNumber:132,columnNumber:19},void 0)},void 0,!1,{fileName:"/Users/otomiranda/Downloads/memora.music/src/pages/AuthCallback.tsx",lineNumber:131,columnNumber:17},void 0)},void 0,!1,{fileName:"/Users/otomiranda/Downloads/memora.music/src/pages/AuthCallback.tsx",lineNumber:130,columnNumber:15},void 0),a.jsxDEV("h2",{className:"text-xl font-semibold text-green-900",children:n("success.title")},void 0,!1,{fileName:"/Users/otomiranda/Downloads/memora.music/src/pages/AuthCallback.tsx",lineNumber:135,columnNumber:15},void 0),a.jsxDEV("p",{className:"text-green-700",children:n("success.subtitle",{countdown:g})},void 0,!1,{fileName:"/Users/otomiranda/Downloads/memora.music/src/pages/AuthCallback.tsx",lineNumber:136,columnNumber:15},void 0),a.jsxDEV("button",{onClick:()=>m(u,{replace:!0}),className:"mt-4 px-6 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:n("success.button")},void 0,!1,{fileName:"/Users/otomiranda/Downloads/memora.music/src/pages/AuthCallback.tsx",lineNumber:137,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/otomiranda/Downloads/memora.music/src/pages/AuthCallback.tsx",lineNumber:129,columnNumber:13},void 0),"error"===b&&a.jsxDEV("div",{className:"space-y-4",children:[a.jsxDEV("div",{className:"rounded-full h-12 w-12 bg-red-100 mx-auto flex items-center justify-center",children:a.jsxDEV("svg",{className:"h-6 w-6 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"},void 0,!1,{fileName:"/Users/otomiranda/Downloads/memora.music/src/pages/AuthCallback.tsx",lineNumber:150,columnNumber:19},void 0)},void 0,!1,{fileName:"/Users/otomiranda/Downloads/memora.music/src/pages/AuthCallback.tsx",lineNumber:149,columnNumber:17},void 0)},void 0,!1,{fileName:"/Users/otomiranda/Downloads/memora.music/src/pages/AuthCallback.tsx",lineNumber:148,columnNumber:15},void 0),a.jsxDEV("h2",{className:"text-xl font-semibold text-red-900",children:n("error.title")},void 0,!1,{fileName:"/Users/otomiranda/Downloads/memora.music/src/pages/AuthCallback.tsx",lineNumber:153,columnNumber:15},void 0),a.jsxDEV("p",{className:"text-red-700 mb-4",children:x},void 0,!1,{fileName:"/Users/otomiranda/Downloads/memora.music/src/pages/AuthCallback.tsx",lineNumber:154,columnNumber:15},void 0),a.jsxDEV("div",{className:"flex flex-col space-y-2",children:[a.jsxDEV("button",{onClick:()=>{N("loading"),h(""),p()},className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:n("error.buttons.retry")},void 0,!1,{fileName:"/Users/otomiranda/Downloads/memora.music/src/pages/AuthCallback.tsx",lineNumber:156,columnNumber:17},void 0),a.jsxDEV("button",{onClick:()=>{m("/?auth=login",{replace:!0})},className:"px-6 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors",children:n("error.buttons.login")},void 0,!1,{fileName:"/Users/otomiranda/Downloads/memora.music/src/pages/AuthCallback.tsx",lineNumber:162,columnNumber:17},void 0),a.jsxDEV("button",{onClick:()=>{m("/",{replace:!0})},className:"px-6 py-2 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 transition-colors",children:n("error.buttons.home")},void 0,!1,{fileName:"/Users/otomiranda/Downloads/memora.music/src/pages/AuthCallback.tsx",lineNumber:168,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/otomiranda/Downloads/memora.music/src/pages/AuthCallback.tsx",lineNumber:155,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/otomiranda/Downloads/memora.music/src/pages/AuthCallback.tsx",lineNumber:147,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/otomiranda/Downloads/memora.music/src/pages/AuthCallback.tsx",lineNumber:119,columnNumber:9},void 0)},void 0,!1,{fileName:"/Users/otomiranda/Downloads/memora.music/src/pages/AuthCallback.tsx",lineNumber:118,columnNumber:7},void 0)},void 0,!1,{fileName:"/Users/otomiranda/Downloads/memora.music/src/pages/AuthCallback.tsx",lineNumber:117,columnNumber:5},void 0)};export{m as default};
